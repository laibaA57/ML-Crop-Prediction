# -*- coding: utf-8 -*-
"""MLmodel.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/14-KEd2i-vdjtzmDqKgi7HnI6S5R5jSl4
"""


import pandas as pd
import pickle
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestClassifier
data = pd.read_csv("Crop_recommendation.csv")

data.head()
data.shape

data.isnull().sum()

"""# split features or labels"""

x=data.iloc[:,:-1]#features
y=data.iloc[:,-1]#labels

x_train, x_test, y_train, y_test = train_test_split(x,y,test_size=0.2,random_state=42)

y_train.head()

x_train.head()

model=RandomForestClassifier()#have trees for decision or give final ouput by taking mode

print(x_train.shape)
print(y_train.shape)

model.fit(x_train,y_train)

predictions=model.predict(x_test)

accuracy=model.score(x_test,y_test)

print("Accuracy:",accuracy)

new_feature=[[36,58,25,28.66024,59.31891,8.399136,36.9263]]
predicted_crop=model.predict(new_feature)
print("Predicted_crop:",predicted_crop)
pickle.dump(model,open("model.pkl","wb"))